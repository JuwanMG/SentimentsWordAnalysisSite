<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Sentiments-Word Analysis</title>
  <link rel="stylesheet" href="sentiment.css">
   <style>#myCanvas { border:1px none #000;}</style>
	<script>
    function setData() {
    var canvas = document.getElementById("myCanvas");
	canvas.width = 900;
	canvas.height = 1000;
    var c = canvas.getContext("2d");
    
    var data;
    var x = 
    //Takes input from user    
    document.getElementById("input").elements[0].value;
    var inputArray = x.split(" ");
    console.log(inputArray);
    console.log(inputArray.join("+"));
    //Formats data for send to twinword
    var orgData = inputArray.join("+");
    //xhtml for twinword
    var rest = new XMLHttpRequest();						
        rest.addEventListener("load", whenLoaded);
        rest.open("GET", "https://twinword-sentiment-analysis.p.mashape.com/analyze/?text="+orgData);	
        rest.setRequestHeader("X-Mashape-Key", "T2cmVJDuJPmshCHII7kAL3Rpxb8cp1XgEIljsnOEXnnnJS4DdY");
        rest.setRequestHeader("Accept", "application/json");
        rest.send();
    
    console.log(rest); 
    
    //Fills data received from twinword
    function whenLoaded(e){
        data = JSON.parse(rest.responseText);
        var score = data.score;
        console.log(score);
        c.beginPath();
        c.moveTo(0,35);
        c.lineTo(500,35);
        c.lineWidth=4;
        c.stroke();
        c.beginPath();
        c.moveTo(250,20);
        c.lineTo(250,50);
        c.stroke();
        var circle;
        if(score>0){
            c.fillStyle = "lightgreen";
        }
        if(score<0){
            c.fillStyle = "red";
        }
        if(data.score>0){
            circle = (data.score*250)+250;
            c.fillRect(circle,25,5,20);
        }
        else if(data.score<0){
            circle = (data.score*250)+250;
            c.fillRect(circle,25,5,20);
        }
        
        var rndScore = (score.toFixed(2))*100;
        console.log(rndScore);
        c.stroke();
        c.font = "15px sansserif";
        c.fillText(rndScore,(circle+7),50);
        c.fillStyle = "black";
        c.fillText("0",246,65);
        var tone = data.score;
        //Displays avg tone
        c.font = "25px sans-serif";
        if (tone>0.3){
             c.fillStyle = "green";
             c.fillText("Postive Tone",175,100);
         }
         else if (tone<-0.3){
             c.fillStyle = "red";
             c.fillText("Negative Tone",175,100); 
         }
        else{
            c.fillStyle = "lightgrey";
            c.fillText("Neutral Tone",175,100);
        } 
         c.fillStyle = "white";
         c.fillText("Positive Words", 10, 150);
         c.fillText("Score",200,150);
         c.fillText("Synonym",280,150);
         c.fillText("Negative Words", 450, 150);
         c.fillText("Score",640,150);
         c.fillText("Synonym",720,150);
         var y = 180;
         var y2 = 180;
        
        c.font = "20px sans-serif";
         for(i=0; data.keywords.length; i++){
             var x;
             var x2;
             var indScore = data.keywords[i].score;
             var rndIndScore = (indScore.toFixed(2))*100;
             if(data.keywords[i].score>0){
                 x = 10;
                 x2 = 200;
                c.fillText(data.keywords[i].word,x,y);
                c.fillText(rndIndScore,x2,y);
                 y += 30;
                 }
                else{
                    x = 450;
                    x2 = 640;
                    c.fillText(data.keywords[i].word,x,y2);
                    c.fillText(rndIndScore,x2,y2);
                    y2 += 30;
                }
              var thes = new XMLHttpRequest();			thes.open("GET","http://words.bighugelabs.com/api/2/a3725d5e48d2513b3782664ae4e6b8ae/" + data.keywords[i].word+"/json");	
            thes.send();
            console.log(thes);
         }
    }
}


 

 
</script>
</head>
<body>
	<h1><a href="Sentiments.html">Sentiments</a></h1>
	<ul>
  <li><a  class="active"
     	href="Sentiments.html">Home</a></li>
 
  <li><a  href="about.html">About</a></li>
</ul>
<p>Welcome to Sentiments the word analysis interface. Type text in the box below to find out how positive or negative your messages truly are.</p>
    
	<form id="input" action="/action_page.php">
  <textarea rows="4" cols="50" name="phrase" form="input" >Enter text here...</textarea>
</form>
<button onclick="setData()">Find your sentiment</button>
<p id="data"></p>
<canvas id="myCanvas"></canvas>
</body>
	<footer>
	<ul>
  <li><a
     	href="Sentiments.html">Home</a></li>
 
  <li><a href="about.html">About</a></li>
</ul>
        <p>Sentiment analysis TwinWord Word Sentiment</p>
	</footer>
</html>


